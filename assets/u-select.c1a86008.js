import{x as e,y as t,o as l,a,w as s,b as u,m as o,n as i,e as n,t as c,j as m,F as h,k as d,d as r,f as p,a6 as f,a7 as _}from"./index-0856ab2f.js";import{_ as x}from"./u-popup.a89850df.js";import{_ as v}from"./_plugin-vue_export-helper.1b428a4d.js";const y=v({emits:["update:modelValue","input","confirm"],props:{value:{type:Boolean,default:!1},modelValue:{type:Boolean,default:!1},list:{type:Array,default:()=>[]},border:{type:Boolean,default:!0},cancelColor:{type:String,default:"#606266"},confirmColor:{type:String,default:"#2979ff"},zIndex:{type:[String,Number],default:0},safeAreaInsetBottom:{type:Boolean,default:!1},maskCloseAble:{type:Boolean,default:!0},defaultValue:{type:Array,default:()=>[0]},mode:{type:String,default:"single-column"},valueName:{type:String,default:"value"},labelName:{type:String,default:"label"},childName:{type:String,default:"children"},title:{type:String,default:""},cancelText:{type:String,default:"取消"},confirmText:{type:String,default:"确认"},blur:{type:[Number,String],default:0}},data:()=>({popupValue:!1,defaultSelector:[0],columnData:[],selectValue:[],lastSelectIndex:[],columnNum:0,moving:!1,reset:!1}),watch:{valueCom:{immediate:!0,handler(e){e&&(this.reset=!0,setTimeout((()=>this.init()),10)),this.popupValue=e}}},computed:{uZIndex(){return this.zIndex?this.zIndex:this.$u.zIndex.popup},valueCom(){return this.modelValue},showColumnCom:()=>!0},methods:{pickstart(){},pickend(){},init(){this.reset=!1,this.setColumnNum(),this.setDefaultSelector(),this.setColumnData(),this.setSelectValue()},setDefaultSelector(){this.defaultSelector=this.defaultValue.length==this.columnNum?this.defaultValue:Array(this.columnNum).fill(0),this.lastSelectIndex=this.$u.deepClone(this.defaultSelector)},setColumnNum(){if("single-column"==this.mode)this.columnNum=1;else if("mutil-column"==this.mode)this.columnNum=this.list.length;else if("mutil-column-auto"==this.mode){let e=1,t=this.list;for(;t[0][this.childName];)t=t[0]?t[0][this.childName]:{},e++;this.columnNum=e}},setColumnData(){let e=[];if(this.selectValue=[],"mutil-column-auto"==this.mode){let t=this.list[this.defaultSelector.length?this.defaultSelector[0]:0];for(let l=0;l<this.columnNum;l++)0==l?(e[l]=this.list,t=t[this.childName]):(e[l]=t,t=t[this.defaultSelector[l]][this.childName])}else"single-column"==this.mode?e[0]=this.list:e=this.list;this.columnData=e},setSelectValue(){let e=null;for(let t=0;t<this.columnNum;t++){e=this.columnData[t][this.defaultSelector[t]];let l={index:this.defaultSelector[t],value:e?e[this.valueName]:null,label:e?e[this.labelName]:null};e&&void 0!==e.extra&&(l.extra=e.extra),this.selectValue.push(l)}},columnChange(e){let t=null,l=e.detail.value;if(this.selectValue=[],"mutil-column-auto"==this.mode){this.lastSelectIndex.map(((e,a)=>{e!=l[a]&&(t=a)})),this.defaultSelector=l;for(let e=t+1;e<this.columnNum;e++)this.columnData[e]=this.columnData[e-1][e-1==t?l[t]:0][this.childName],this.defaultSelector[e]=0;l.map(((e,t)=>{let a=this.columnData[t][l[t]],s={index:l[t],value:a?a[this.valueName]:null,label:a?a[this.labelName]:null};a&&void 0!==a.extra&&(s.extra=a.extra),this.selectValue.push(s)})),this.lastSelectIndex=l}else if("single-column"==this.mode){let e=this.columnData[0][l[0]],t={index:l[0],value:e?e[this.valueName]:null,label:e?e[this.labelName]:null};e&&void 0!==e.extra&&(t.extra=e.extra),this.selectValue.push(t),this.lastSelectIndex=l}else"mutil-column"==this.mode&&(l.map(((e,t)=>{let a=this.columnData[t][l[t]],s={index:l[t],value:a?a[this.valueName]:null,label:a?a[this.labelName]:null};a&&void 0!==a.extra&&(s.extra=a.extra),this.selectValue.push(s)})),this.lastSelectIndex=l)},close(){this.$emit("input",!1),this.$emit("update:modelValue",!1)},getResult(e=null){e&&this.$emit(e,this.selectValue),this.close()},selectHandler(){this.$emit("click")}}},[["render",function(v,y,S,N,b,g){const C=p,V=f,k=_,I=e(t("u-popup"),x);return l(),a(C,{class:"u-select"},{default:s((()=>[u(I,{blur:S.blur,maskCloseAble:S.maskCloseAble,mode:"bottom",popup:!1,modelValue:b.popupValue,"onUpdate:modelValue":y[4]||(y[4]=e=>b.popupValue=e),length:"auto",safeAreaInsetBottom:S.safeAreaInsetBottom,onClose:g.close,"z-index":g.uZIndex},{default:s((()=>[u(C,{class:"u-select"},{default:s((()=>[u(C,{class:"u-select__header",onTouchmove:y[3]||(y[3]=o((()=>{}),["stop","prevent"]))},{default:s((()=>[u(C,{class:"u-select__header__cancel u-select__header__btn",style:i({color:S.cancelColor}),"hover-class":"u-hover-class","hover-stay-time":150,onClick:y[0]||(y[0]=e=>g.getResult("cancel"))},{default:s((()=>[n(c(S.cancelText),1)])),_:1},8,["style"]),u(C,{class:"u-select__header__title"},{default:s((()=>[n(c(S.title),1)])),_:1}),u(C,{class:"u-select__header__confirm u-select__header__btn",style:i({color:b.moving?S.cancelColor:S.confirmColor}),"hover-class":"u-hover-class","hover-stay-time":150,onTouchmove:y[1]||(y[1]=o((()=>{}),["stop"])),onClick:y[2]||(y[2]=o((e=>g.getResult("confirm")),["stop"]))},{default:s((()=>[n(c(S.confirmText),1)])),_:1},8,["style"])])),_:1}),u(C,{class:"u-select__body"},{default:s((()=>[u(k,{onChange:g.columnChange,class:"u-select__body__picker-view",value:b.defaultSelector,onPickstart:g.pickstart,onPickend:g.pickend},{default:s((()=>[g.showColumnCom?(l(!0),m(h,{key:0},d(b.columnData,((e,t)=>(l(),a(V,{key:t},{default:s((()=>[(l(!0),m(h,null,d(e,((e,t)=>(l(),a(C,{class:"u-select__body__picker-view__item",key:t},{default:s((()=>[u(C,{class:"u-line-1"},{default:s((()=>[n(c(e[S.labelName]),1)])),_:2},1024)])),_:2},1024)))),128))])),_:2},1024)))),128)):r("",!0)])),_:1},8,["onChange","value","onPickstart","onPickend"])])),_:1})])),_:1})])),_:1},8,["blur","maskCloseAble","modelValue","safeAreaInsetBottom","onClose","z-index"])])),_:1})}],["__scopeId","data-v-1c3e96c5"]]);export{y as _};
